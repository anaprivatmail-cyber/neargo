<!doctype html>
<html lang="sl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NearGo ‚Äì Premium naroƒçnina</title>

  <!-- PWA -->
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0bbbd6">

  <style>
    :root{
      --brand:#0bbbd6; --text:#0b1b2b; --muted:#5b6b7b; --card:#fff;
      --chip:#fff; --chipborder:#cfe1ee; --shadow:0 10px 30px rgba(0,0,0,.08);
      --radius:16px; --primary:#0bbbd6; --focus:#bfeef6; --gap:16px;
      --ok:#11a67a; --bad:#d64c4c;
    }
    body.dark{--text:#e8f0f8; --muted:#b8c3cf; --card:#0f1f30; --chip:#102437; --chipborder:#19324a; --focus:#123956}
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at -10% -10%, rgba(11,187,214,.25) 0%, rgba(11,187,214,0) 60%),
        linear-gradient(180deg, #e9f7ff 0%, #ffffff 70%);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; line-height:1.25;
    }
    a{ color:inherit; text-decoration:none }

    /* HEADER - enostaven za premium */
    header{position:sticky; top:0; z-index:30; backdrop-filter:blur(6px); background:color-mix(in srgb, var(--card) 88%, transparent); box-shadow:0 4px 16px rgba(0,0,0,.05);}
    .nav{ max-width:1100px; margin:0 auto; padding:12px 24px; display:flex; align-items:center; justify-content:space-between; }

    .brand{ display:flex; align-items:center; gap:10px; font-weight:900; font-size:20px }
    .brand svg{width:26px; height:26px}
    @keyframes slowPulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.07);opacity:.95}100%{transform:scale(1);opacity:1}}
    .pulse{animation:slowPulse 2.8s ease-in-out infinite; transform-origin:center}

    .btn{background:var(--primary); color:#fff; border:none; padding:12px 18px; border-radius:14px; font-weight:900; cursor:pointer; font-size:16px}
    .btn.mini{padding:8px 12px; font-size:13px; border-radius:12px}
    .btn.link{background:#fff; color:#000; border:1px solid var(--chipborder)}

    /* LAYOUT */
    main{max-width:1100px; margin:0 auto; padding:24px 24px 64px}
    .card{background:var(--card); box-shadow:var(--shadow); border-radius:var(--radius); padding:20px; border:1px solid var(--chipborder); margin-bottom:16px}
    .title{font-weight:900; margin-bottom:10px; font-size:1.5rem}
    .muted{color:var(--muted)}

    /* Premium specific styles */
    .premium-hero {
      text-align: center;
      background: linear-gradient(135deg, var(--primary) 0%, #7de3f0 100%);
      color: white;
      border-radius: var(--radius);
      padding: 32px 20px;
      margin-bottom: 24px;
    }
    
    .premium-hero h1 {
      margin: 0 0 12px 0;
      font-size: 2.2rem;
      font-weight: 900;
    }
    
    .premium-hero .price {
      font-size: 3rem;
      font-weight: 900;
      margin: 16px 0 8px 0;
    }
    
    .premium-hero .period {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .benefits-list {
      list-style: none;
      padding: 0;
      margin: 20px 0;
    }
    
    .benefits-list li {
      padding: 12px 0;
      border-bottom: 1px solid var(--chipborder);
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    
    .benefits-list li:last-child {
      border-bottom: none;
    }
    
    .benefit-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      font-size: 14px;
      flex-shrink: 0;
      margin-top: 2px;
    }
    
    .benefit-text {
      flex: 1;
    }
    
    .benefit-title {
      font-weight: 900;
      color: var(--text);
      margin-bottom: 4px;
    }
    
    .benefit-desc {
      color: var(--muted);
      font-size: 14px;
      line-height: 1.4;
    }

    .cta-section {
      text-align: center;
      padding: 24px 0;
    }
    
    .cta-button {
      background: linear-gradient(135deg, var(--primary) 0%, #7de3f0 100%);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 12px;
      font-weight: 900;
      font-size: 18px;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: transform 0.2s ease;
      width: 100%;
      max-width: 300px;
    }
    
    .cta-button:hover {
      transform: translateY(-2px);
    }
    
    .cta-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    /* Toast */
    .toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:12px; z-index:1002; display:none; padding:10px 14px; border-radius:12px; font-weight:800 }
    .toast.ok{ background:#e6fbf5; color:#05614d; border:1px solid #baf0df }
    .toast.bad{ background:#ffeaea; color:#7a1b1b; border:1px solid #ffd1d1 }

    /* Development helper - mobilni pogled na desktop */
    @media (min-width: 768px) {
      body {
        max-width: 390px;
        margin: 0 auto;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand" aria-label="NearGo">
        <svg viewBox="0 0 32 32" aria-hidden="true">
          <defs><radialGradient id="g1" cx="50%" cy="50%"><stop offset="0%" stop-color="#0bbbd6"/><stop offset="100%" stop-color="#7de3f0"/></radialGradient></defs>
          <circle cx="16" cy="16" r="13" class="ring" fill="none" stroke="url(#g1)" stroke-width="2"/>
          <circle cx="16" cy="16" r="8" class="ring" fill="none" stroke="url(#g1)" stroke-width="2" opacity=".9"/>
          <circle cx="16" cy="16" r="3.2" class="dot pulse" fill="url(#g1)"/>
        </svg>
        NearGo
      </div>
      <a class="btn link" href="/">‚Üê Nazaj na glavno stran</a>
    </div>
  </header>

  <main>
    <!-- Premium Hero Section -->
    <div class="premium-hero">
      <h1>NearGo Premium</h1>
      <p>Dobite veƒç od svojih dogodkov in storitev</p>
      <div class="price">5‚Ç¨</div>
      <div class="period">na mesec</div>
    </div>

    <!-- Premium Benefits -->
    <section class="card">
      <div class="title">Kaj vam Premium ponuja?</div>
      
      <ul class="benefits-list">
        <li>
          <div class="benefit-icon">üéüÔ∏è</div>
          <div class="benefit-text">
            <div class="benefit-title">Brezplaƒçni kuponi</div>
            <div class="benefit-desc">Izdaja kuponov 0 ‚Ç¨ namesto 2 ‚Ç¨ za vsak kupon</div>
          </div>
        </li>
        
        <li>
          <div class="benefit-icon">üîî</div>
          <div class="benefit-text">
            <div class="benefit-title">Prednostna obvestila</div>
            <div class="benefit-desc">Prva izveste o novih ponudbah v va≈°i bli≈æini</div>
          </div>
        </li>
        
        <li>
          <div class="benefit-icon">‚≠ê</div>
          <div class="benefit-text">
            <div class="benefit-title">Ekskluzivne akcije</div>
            <div class="benefit-desc">Dostop do posebnih popustov in "happy hour" terminov</div>
          </div>
        </li>
        
        <li>
          <div class="benefit-icon">üéØ</div>
          <div class="benefit-text">
            <div class="benefit-title">Prioritetno iskanje</div>
            <div class="benefit-desc">Va≈°e objave se poka≈æejo vi≈°je v rezultatih iskanja</div>
          </div>
        </li>
      </ul>
    </section>

    <!-- Comparison -->
    <section class="card">
      <div class="title">Primerjava paketov</div>
      
      <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; margin-top: 12px;">
          <thead>
            <tr style="background: var(--chipborder);">
              <th style="padding: 12px 8px; text-align: left; font-weight: 900;">Funkcionalnost</th>
              <th style="padding: 12px 8px; text-align: center; font-weight: 900;">Brezplaƒçno</th>
              <th style="padding: 12px 8px; text-align: center; font-weight: 900; color: var(--primary);">Premium</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 10px 8px; border-bottom: 1px solid var(--chipborder);">Objava dogodkov</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder);">‚úÖ</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder);">‚úÖ</td>
            </tr>
            <tr>
              <td style="padding: 10px 8px; border-bottom: 1px solid var(--chipborder);">Izdaja kuponov</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder);">2‚Ç¨/kupon</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder); color: var(--primary); font-weight: 900;">BREZPLAƒåNO</td>
            </tr>
            <tr>
              <td style="padding: 10px 8px; border-bottom: 1px solid var(--chipborder);">Obvestila o novih ponudbah</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder);">Standard</td>
              <td style="padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--chipborder); color: var(--primary); font-weight: 900;">PREDNOSTNO</td>
            </tr>
            <tr>
              <td style="padding: 10px 8px;">Ekskluzivne akcije</td>
              <td style="padding: 10px 8px; text-align: center;">‚ùå</td>
              <td style="padding: 10px 8px; text-align: center; color: var(--primary); font-weight: 900;">‚úÖ</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
      <button class="cta-button" id="btnGoPremium">
        Naroƒçi Premium za 5‚Ç¨/mesec
      </button>
      <div class="muted" id="premMsg" style="margin-top: 12px; font-size: 14px;"></div>
      
      <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--chipborder); color: var(--muted); font-size: 13px; line-height: 1.4;">
        <p style="margin: 0;">‚Ä¢ Meseƒçna naroƒçnina, prekliƒçite kadarkoli</p>
        <p style="margin: 4px 0 0 0;">‚Ä¢ Plaƒçilo prek Apple/Google ali Stripe</p>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <script>
    "use strict";

    /* UTIL */
    const $ = s => document.querySelector(s);

    /* Toast */
    function showToast(msg, ok = true) {
      const t = $("#toast");
      if (!t) return;
      t.textContent = msg;
      t.className = "toast " + (ok ? "ok" : "bad");
      t.style.display = "flex";
      setTimeout(() => t.style.display = "none", 4000);
    }

    /* Premium IAP */
    $("#btnGoPremium")?.addEventListener("click", async () => {
      const btn = $("#btnGoPremium");
      const msg = $("#premMsg");
      
      if (btn) btn.disabled = true;
      if (msg) msg.textContent = "Povezujem plaƒçilo...";
      
      try {
        const response = await fetch("/api/iap/start", {
          method: "POST",
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ plan: "premium5" })
        });
        
        const result = await response.json();
        
        if (result && result.ok && result.url) {
          location.href = result.url;
        } else if (result && result.fallback === 'stripe' && result.url) {
          location.href = result.url;
        } else {
          if (msg) msg.textContent = "Plaƒçilo ni uspelo.";
          showToast("Plaƒçilo trenutno ni na voljo.", false);
        }
      } catch (error) {
        if (msg) msg.textContent = "Napaka pri plaƒçilu.";
        showToast("Napaka pri povezavi s plaƒçilnim sistemom.", false);
      } finally {
        if (btn) btn.disabled = false;
      }
    });

    // Handle success/error URLs
    if (location.hash === "#success") {
      showToast("Premium uspe≈°no aktiviran! üéâ", true);
      history.replaceState(null, "", location.pathname);
    }
    
    if (location.hash === "#cancel") {
      showToast("Naroƒçnina preklicana.", false);
      history.replaceState(null, "", location.pathname);
    }
  </script>
</body>
</html>