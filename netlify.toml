# netlify.toml — konfiguracija builda, funkcij in API preusmeritev

#################################
# BUILD
#################################
[build]
  publish   = "."
  functions = "netlify/functions"

#################################
# FUNKCIJE (timeout, bundling)
#################################
# Globalne nastavitve za vse Netlify Functions
[functions]
  node_bundler = "esbuild"

# Privzete nastavitve za VSE funkcije (lahko presežeš po-imensko spodaj)
# Opomba: 26s je največ za navadne functions.
[functions."*"]
  timeout = 26
  # Če boš kdaj potrebovala vključiti zunanje module ali datoteke, dodaš:
  # external_node_modules = []
  # included_files = []

# Primer: če želiš specifično daljši timeout za iskalnik:
# [functions."tm-search"]
#   timeout = 26


#################################
# PREUSMERITVE (API → Functions)
#################################

# Iskalnik (Ticketmaster + Eventbrite)
[[redirects]]
  from = "/api/search"
  to   = "/.netlify/functions/tm-search"
  status = 200
  force  = true

# Plačila (Stripe) — če uporabljaš Checkout funkcijo
[[redirects]]
  from = "/api/checkout"
  to   = "/.netlify/functions/checkout"
  status = 200
  force  = true

# Oddaja dogodkov (ponudniki)
[[redirects]]
  from = "/api/provider-submit"
  to   = "/.netlify/functions/provider-submit"
  status = 200
  force  = true

# Seznam ponudnikov (original)
[[redirects]]
  from = "/api/provider-list"
  to   = "/.netlify/functions/provider-list"
  status = 200
  force  = true

# Alias za /api/providers → provider-list
[[redirects]]
  from = "/api/providers"
  to   = "/.netlify/functions/provider-list"
  status = 200
  force  = true

# Analitika (če imaš funkcijo analytics.js)
[[redirects]]
  from = "/api/analytics"
  to   = "/.netlify/functions/analytics"
  status = 200
  force  = true


#################################
# (NEOBVEZNO) HTTP glave / cache
#################################

# Statični asseti naj se agresivno keširajo
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# HTML naj se ne kešira (da takoj vidiš spremembe)
[[headers]]
  for = "/*"
  [headers.values]
    Cache-Control = "no-cache"
