<!doctype html>
<html lang="sl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>NearGo – Za organizatorje</title>
  <style>
    :root{ --bg:#f6fbfe; --card:#fff; --text:#0b1b2b; --muted:#5b6b7b; --border:#e6eef7; --brand:#0bbbd6; --brand2:#089ab1; --shadow:0 12px 30px rgba(0,0,0,.06); }
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{max-width:900px;margin:24px auto;padding:16px}
    .card{background:#fff;border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:18px}
    h1{margin:6px 0 12px;font-size:24px}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:10px}
    @media(min-width:680px){ .grid{grid-template-columns:1fr 1fr 1fr} }
    .btn{display:block;text-align:center;text-decoration:none;padding:16px;border-radius:16px;font-weight:900;box-shadow:var(--shadow)}
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand2)); color:#fff; border:0;}
    .btn.link{background:#fff;color:var(--text);border:1px solid var(--border)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
    input{flex:1;padding:10px;border-radius:10px;border:1px solid var(--border)}
    label{font-weight:800}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Za organizatorje</h1>
      <div class="muted">Vnesi svoje podatke (shranijo se na tej napravi), nato izberi akcijo.</div>

      <div class="row">
        <label>E-pošta</label>
        <input id="email" placeholder="za Moje vstopnice">
      </div>
      <div class="row">
        <label>Event ID</label>
        <input id="eventId" placeholder="npr. 123456 (opcijsko)">
      </div>
      <div class="row">
        <label>Stats token</label>
        <input id="stats" placeholder="prilepi token iz e-pošte">
      </div>
      <div class="row">
        <label>Scanner key</label>
        <input id="key" placeholder="SCANNER_KEY za skener">
      </div>
      <div class="row">
        <button id="save" class="btn link" style="padding:10px 14px">💾 Shrani</button>
      </div>

      <div class="grid">
        <a id="goPublish" class="btn link" href="/#orgPanel">Objavi dogodek</a>
        <a id="goScan"    class="btn primary" href="#">Skeniraj QR</a>
        <a id="goStats"   class="btn link" href="#">Analitika</a>
      </div>

      <div class="row" style="margin-top:10px">
        <a id="goMine" class="btn link" href="/my.html" style="flex:1">Moje vstopnice</a>
      </div>

      <div id="msg" class="muted" style="margin-top:10px"></div>
    </div>
  </div>

<script>
  const $=s=>document.querySelector(s);
  const msg=$("#msg"), F={ email:$("#email"), eventId:$("#eventId"), stats:$("#stats"), key:$("#key") };

  // prefill
  (function load(){
    F.email.value   = localStorage.getItem("user_email")   || "";
    F.eventId.value = localStorage.getItem("event_id")     || localStorage.getItem("default_event") || "";
    F.stats.value   = localStorage.getItem("stats_token")  || "";
    F.key.value     = localStorage.getItem("scanner_key")  || "";
  })();

  $("#save").onclick = ()=>{
    localStorage.setItem("user_email",   F.email.value.trim());
    if (F.eventId.value.trim()) localStorage.setItem("event_id", F.eventId.value.trim());
    if (F.stats.value.trim())   localStorage.setItem("stats_token", F.stats.value.trim());
    if (F.key.value.trim())     localStorage.setItem("scanner_key", F.key.value.trim());
    msg.textContent = "Shranjeno.";
  };

  // objava dogodka -> glavna stran & scroll do panel
  $("#goPublish").onclick = (e)=>{
    e.preventDefault();
    // Pusti anchor – SPA bo odprl panel, ali pa naj uporabnik klikne “Objavi dogodek”
    location.href = "/#orgPanel";
  };

  // skeniranje (z verzijo za obid PWA cacha)
  $("#goScan").onclick = (e)=>{
    e.preventDefault();
    const p = new URLSearchParams();
    if (F.key.value.trim())   p.set("k", F.key.value.trim());
    if (F.eventId.value.trim()) p.set("eventId", F.eventId.value.trim());
    if (F.stats.value.trim()) p.set("stats", F.stats.value.trim());
    location.href = "/scan.html?v=2" + (p.toString()?("&"+p.toString()):"");
  };

  // analitika (isti URL kot v mailu)
  $("#goStats").onclick = (e)=>{
    e.preventDefault();
    if (!F.stats.value.trim()) { msg.textContent="Vnesi stats token."; return; }
    const p = new URLSearchParams({ stats:F.stats.value.trim() });
    if (F.eventId.value.trim()) p.set("eventId", F.eventId.value.trim());
    location.href = "/org-stats.html?"+p.toString();
  };

  // moje vstopnice berejo e-pošto iz localStorage
</script>
</body>
</html>
