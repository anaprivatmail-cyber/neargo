<!doctype html>
<html lang="sl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pozabljeno geslo – NearGo</title>
  <script type="module" src="/assets/sw-reload.js?v=f8287c1cc1"></script>
  <link rel="canonical" href="/forgot-password.html">
  <style>
    body { font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:#f7fbfd; margin:0; }
    .center { max-width:340px; margin:40px auto; background:#fff; border-radius:16px; box-shadow:0 4px 32px rgba(0,0,0,0.13); padding:28px 22px; }
    .brand { display:flex;align-items:center;gap:10px;text-decoration:none;justify-content:center;margin-bottom:18px; }
    .btn { border:none; padding:12px 18px; border-radius:14px; font-weight:900; cursor:pointer; font-size:16px; background:#0bbbd6; color:#fff; width:100%; margin-top:10px; }
    .muted { color:#5b6b7b; font-size:15px; text-align:center; margin-bottom:18px; }
    input { width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #cfe1ee; font-size:15px; }
    .error { color:#d64c4c; font-size:14px; text-align:center; margin-bottom:8px; }
  </style>
</head>
<body>
  <div class="center">
    <a href="/" class="brand" aria-label="NearGo">
      <svg viewBox="0 0 32 32" aria-hidden="true" style="width:38px;height:38px;">
        <defs><radialGradient id="g1" cx="50%" cy="50%"><stop offset="0%" stop-color="#0bbbd6"/><stop offset="100%" stop-color="#7de3f0"/></radialGradient></defs>
        <circle cx="16" cy="16" r="13" class="ring" fill="none" stroke="url(#g1)" stroke-width="2"/>
        <circle cx="16" cy="16" r="8" class="ring" fill="none" stroke="url(#g1)" stroke-width="2" opacity=".9"/>
        <circle cx="16" cy="16" r="3.2" class="dot pulse"/>
      </svg>
      <span style="font-weight:900;font-size:22px;color:#14202b;letter-spacing:-1px;">NearGo</span>
    </a>
    <div class="muted">Obnovitev gesla</div>
    <form id="forgotForm">
      <input type="email" id="forgotEmail" placeholder="Vnesite e-pošto" required>
      <button type="submit" class="btn">Pošlji povezavo za obnovitev</button>
    </form>
    <div id="forgotError" class="error" style="display:none"></div>
    <div class="muted"><a href="/organizers.html">Nazaj na prijavo</a></div>
  </div>
  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    const SUPABASE_URL = "https://wqdfteajjcrzcniotvhh.supabase.co";
    const SUPABASE_ANON_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndxZGZ0ZWFqamNyemNuaW90dmhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzNTU3MDMsImV4cCI6MjA3MTkzMTcwM30.0EFgeCpHcsSxsYQ2wZIQerLKXcAlvJjVNuQ0nJB2VFc";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    document.getElementById('forgotForm').addEventListener('submit', async function(ev) {
      ev.preventDefault();
      var email = document.getElementById('forgotEmail').value.trim();
      if (!email) {
        document.getElementById('forgotError').textContent = 'Vnesite e-pošto.';
        document.getElementById('forgotError').style.display = 'block';
        return;
      }
      document.getElementById('forgotError').textContent = 'Pošiljam...';
      document.getElementById('forgotError').style.display = 'block';
      document.getElementById('forgotError').style.color = '#0b4c68';
      try {
        const { error } = await supabase.auth.resetPasswordForEmail(email, {
          redirectTo: window.location.origin + '/auth-callback.html'
        });
        if (error) throw error;
        document.getElementById('forgotError').textContent = 'Če je e-pošta registrirana, boste prejeli povezavo za obnovitev gesla.';
        document.getElementById('forgotError').style.color = '#0b8a62';
      } catch (error) {
        console.error('Reset password error:', error);
        document.getElementById('forgotError').textContent = 'Napaka: ' + (error.message || error);
        document.getElementById('forgotError').style.color = '#d64c4c';
      }
    });
  </script>
</body>
</html>
