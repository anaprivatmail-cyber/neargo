<!DOCTYPE html>
<html lang="sl">
<head>
	<meta charset="UTF-8">
	<title>Premium uporabnik</title>
	<link rel="stylesheet" href="assets/app.css">
	<script src="assets/boot-utils.js"></script>
	<script type="module" src="assets/categories.js"></script>
</head>
<body>
	<header style="background:linear-gradient(90deg,#e9f7ff 60%,#0bbbd6 100%);padding:18px 0 10px 0;box-shadow:0 2px 12px rgba(11,187,214,.08);margin-bottom:18px;">
		<div style="max-width:900px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;">
			<a href="/" style="font-size:1.7em;font-weight:900;color:#0bbbd6;text-decoration:none;letter-spacing:-1px;">NearGo</a>
					<nav>
						<a href="/my.html" style="font-weight:700;color:#111;margin-right:18px;">Moje</a>
						<a href="/premium.html" style="font-weight:700;color:#0bbbd6;">Premium</a>
					</nav>
		</div>
	</header>

		<div class="card" style="max-width:540px;margin:38px auto 28px auto;padding:38px 28px;text-align:center;box-shadow:0 8px 32px rgba(11,187,214,.12);border-radius:24px;background:linear-gradient(120deg,#e9f7ff 60%,#f6fff9 100%);">
			<img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Premium" style="width:72px;height:72px;margin-bottom:18px;filter:drop-shadow(0 2px 8px #0bbbd6);">
		<h1 style="font-size:2.3em;margin-bottom:12px;color:#0bbbd6;letter-spacing:-1px;">Premium NearGo</h1>
		<div style="font-size:1.15em;margin-bottom:18px;color:#111;font-weight:600;">Več kot samo dogodki – odklenite izkušnjo, ki jo želite!</div>
		<ul style="text-align:left;max-width:340px;margin:0 auto 22px auto;font-size:1.08em;line-height:1.7;color:#0b1b2b;">
			<li><b style="color:#0bbbd6">Predčasna obvestila</b> o novih dogodkih in storitvah</li>
			<li><b style="color:#0bbbd6">Ekskluzivne ponudbe</b> in popusti</li>
			<li><b style="color:#0bbbd6">Napredni filtri</b> in iskanje</li>
			<li><b style="color:#0bbbd6">Brez oglasov</b> in hitrejša uporaba</li>
			<li><b style="color:#0bbbd6">VIP podpora</b> in presenečenja</li>
			<li id="premiumMore" style="color:#11a67a;font-weight:700;">... in še več inovativnih funkcij!</li>
		</ul>
			<div style="margin:18px 0 10px 0;">
				<span style="display:inline-block;background:#0bbbd6;color:#fff;padding:8px 18px;border-radius:999px;font-weight:900;font-size:1.1em;box-shadow:0 2px 12px rgba(11,187,214,.10);">Premium = več svobode, več ugodnosti</span>
			</div>

			<div style="margin:24px 0 10px 0;text-align:left;">
				<table style="width:100%;border-collapse:collapse;font-size:1em;">
					<thead>
						<tr style="background:#e9f7ff;color:#0bbbd6;font-weight:900;">
							<th style="padding:8px 0;border-bottom:2px solid #0bbbd6;">Navadni</th>
							<th style="padding:8px 0;border-bottom:2px solid #0bbbd6;">Premium</th>
						</tr>
					</thead>
					<tbody>
						<tr><td style="padding:8px 0;">Omejeni filtri</td><td style="padding:8px 0;">Napredni filtri</td></tr>
						<tr><td style="padding:8px 0;">Občasni popusti</td><td style="padding:8px 0;">Ekskluzivne ponudbe</td></tr>
						<tr><td style="padding:8px 0;">Obvestila z zamikom</td><td style="padding:8px 0;">Predčasna obvestila</td></tr>
						<tr><td style="padding:8px 0;">Oglasi</td><td style="padding:8px 0;">Brez oglasov</td></tr>
						<tr><td style="padding:8px 0;">Standardna podpora</td><td style="padding:8px 0;">VIP podpora</td></tr>
					</tbody>
				</table>
			</div>
		<form id="premiumEmailForm" style="margin-bottom:18px;">
			<input type="email" id="premiumEmail" placeholder="Vpišite svoj email" required style="padding:10px 16px;border-radius:999px;border:1px solid #0bbbd6;font-size:1em;width:80%;max-width:320px;margin-bottom:8px;">
			<button type="submit" id="btnBuyPremium" style="background:linear-gradient(90deg,#0bbbd6,#11a67a);color:#fff;font-weight:900;font-size:1.15em;padding:12px 34px;border:none;border-radius:999px;box-shadow:0 2px 12px rgba(11,187,214,.12);cursor:pointer;transition:background .2s;">Nadgradi v Premium</button>
				<script>
				document.addEventListener('DOMContentLoaded', function() {
					var buyPremiumBtn = document.getElementById('btnBuyPremium');
					if (buyPremiumBtn) {
						buyPremiumBtn.onclick = function(e) {
							var loggedIn = !!localStorage.getItem('user_email') || !!localStorage.getItem('user_token');
							if (!loggedIn) {
								window.location.href = '/login.html?redirect=premium';
								e.preventDefault();
								return false;
							}
						};
					}
				});
				</script>
		</form>
		<div id="premiumEmailConfirmation" style="display:none;color:#11a67a;font-weight:700;margin-bottom:8px;"></div>
		<script>
		function isMobileStore() {
			const ua = navigator.userAgent || navigator.vendor || window.opera;
			// Google Play WebView
			if (/Android/.test(ua) && (/wv/.test(ua) || /Version\/\d+\.\d+/.test(ua))) return true;
			// iOS App Store WebView
			if (/iPhone|iPad|iPod/.test(ua) && /AppleWebKit/.test(ua) && !/Safari/.test(ua)) return true;
			// Capacitor/Cordova/ReactNative
			if (window.Capacitor || window.cordova || window.ReactNativeWebView) return true;
			return false;
		}
		document.addEventListener('DOMContentLoaded', function() {
			if (isMobileStore()) {
				document.getElementById('premiumEmailForm').style.display = 'none';
				document.getElementById('premiumEmailConfirmation').style.display = 'block';
				document.getElementById('premiumEmailConfirmation').textContent = 'Nakup Premium v mobilni aplikaciji poteka preko Google Play ali Apple Store.';
				document.getElementById('premiumEmailConfirmation').style.color = '#d64c4c';
			}
		});
		</script>
	</div>

	<section id="earlyNotifySection" style="max-width:500px;margin:0 auto 24px auto;">
		<h2>Predčasna obvestila</h2>
		<p>Izberite kategorije ali tipe ponudb, za katere želite prejemati predčasna obvestila:</p>
		<form id="earlyNotifyForm">
			<div id="earlyNotifyCategoryList" style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;"></div>
			<label style="margin-top:10px;display:block;">Lokacija (kraj): <input type="text" name="location" id="earlyNotifyLocation" placeholder="npr. Ljubljana"></label>
			<label style="margin-top:6px;display:block;">Radij (km): <input type="number" name="radius" id="earlyNotifyRadius" min="1" max="400" value="30" style="width:80px;"></label>
			<button type="submit" style="margin-top:14px;">Shrani nastavitve</button>
		</form>
		<div id="earlyNotifyConfirmation" style="display:none; color:green; margin-top:10px;"></div>
	</section>
	<script type="module" src="assets/js/app.js"></script>
<script>
document.getElementById('premiumEmailForm')?.addEventListener('submit', async function(e) {
	e.preventDefault();
	const email = document.getElementById('premiumEmail')?.value?.trim();
	const confirmation = document.getElementById('premiumEmailConfirmation');
	if (!email) {
		confirmation.textContent = 'Vpišite email.';
		confirmation.style.display = 'block';
		confirmation.style.color = 'red';
		return;
	}
	// Stripe Checkout za Premium
	try {
		const payload = {
			type: 'premium',
			email,
			successUrl: `${location.origin}/premium.html#success`,
			cancelUrl: `${location.origin}/premium.html#cancel`
		};
		const r = await fetch('/api/checkout', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify(payload)
		}).then(x => x.json());
			if (r && r.ok && r.url) {
				location.href = r.url;
			} else {
				confirmation.textContent = 'Nakup Premium ni uspel.';
				confirmation.style.display = 'block';
				confirmation.style.color = 'red';
			}
	} catch {
			confirmation.textContent = 'Nakup Premium ni uspel.';
		confirmation.style.display = 'block';
		confirmation.style.color = 'red';
	}
});
</script>
</body>
</html>
