# netlify.toml – konfiguracija builda, API preusmeritev in headerji
[build]
  publish = "."
  functions = "netlify/functions"

[functions]
  node_bundler = "esbuild"
  included_files = []
  directory = "netlify/functions"
  # več časa za počasne RSS/ICS vire
  timeout = 20

###############
# Redirects   #
###############

# Iskalnik (tm-search.js)
[[redirects]]
  from = "/api/search"
  to = "/.netlify/functions/tm-search"
  status = 200
  force = true

# Plačila (Stripe) – placeholder
[[redirects]]
  from = "/api/checkout"
  to = "/.netlify/functions/checkout"
  status = 200
  force = true

# Oddaja dogodkov (ponudniki)
[[redirects]]
  from = "/api/provider-submit"
  to = "/.netlify/functions/provider-submit"
  status = 200
  force = true

# Seznam ponudnikov
[[redirects]]
  from = "/api/provider-list"
  to = "/.netlify/functions/provider-list"
  status = 200
  force = true

# Alias /api/providers → provider-list
[[redirects]]
  from = "/api/providers"
  to = "/.netlify/functions/provider-list"
  status = 200
  force = true

# Analitika (če jo uporabljaš)
[[redirects]]
  from = "/api/analytics"
  to = "/.netlify/functions/analytics"
  status = 200
  force = true

###############
# Headers     #
###############
[[headers]]
  for = "/api/*"
  [headers.values]
  Access-Control-Allow-Origin = "*"
  Cache-Control = "public, max-age=30, stale-while-revalidate=60"
